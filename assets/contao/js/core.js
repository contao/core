/* Contao Open Source CMS, (c) 2005-2016 Leo Feyer, LGPL license */
var AjaxRequest={themePath:Contao.script_url+"system/themes/"+Contao.theme+"/images/",toggleNavigation:function(a,b){a.blur();var c=$(b),d=$(a).getFirst("img");return c?("none"==c.getStyle("display")?(c.setStyle("display",null),d.src=AjaxRequest.themePath+"modMinus.gif",$(a).store("tip:title",Contao.lang.collapse),(new Request.Contao).post({action:"toggleNavigation",id:b,state:1,REQUEST_TOKEN:Contao.request_token})):(c.setStyle("display","none"),d.src=AjaxRequest.themePath+"modPlus.gif",$(a).store("tip:title",Contao.lang.expand),(new Request.Contao).post({action:"toggleNavigation",id:b,state:0,REQUEST_TOKEN:Contao.request_token})),!1):(new Request.Contao({evalScripts:!0,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(c){var e=new Element("li",{id:b,"class":"tl_parent",html:c,styles:{display:"inline"}}).inject($(a).getParent("li"),"after");e.getElements("a").each(function(a){a.href=a.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)}),$(a).store("tip:title",Contao.lang.collapse),d.src=AjaxRequest.themePath+"modMinus.gif",AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"loadNavigation",id:b,state:1,REQUEST_TOKEN:Contao.request_token}),!1)},toggleStructure:function(a,b,c,d){a.blur();var e=$(b),f=$(a).getFirst("img");return e?("none"==e.getStyle("display")?(e.setStyle("display",null),f.src=AjaxRequest.themePath+"folMinus.gif",$(a).store("tip:title",Contao.lang.collapse),new Request.Contao({field:a}).post({action:"toggleStructure",id:b,state:1,REQUEST_TOKEN:Contao.request_token})):(e.setStyle("display","none"),f.src=AjaxRequest.themePath+"folPlus.gif",$(a).store("tip:title",Contao.lang.expand),new Request.Contao({field:a}).post({action:"toggleStructure",id:b,state:0,REQUEST_TOKEN:Contao.request_token})),!1):(new Request.Contao({field:a,evalScripts:!0,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(e){var g=new Element("li",{id:b,"class":"parent",styles:{display:"inline"}});if(new Element("ul",{"class":"level_"+c,html:e}).inject(g,"bottom"),5==d)g.inject($(a).getParent("li"),"after");else{for(var j,h=!1,i=$(a).getParent("li");"element"==typeOf(i)&&(j=i.getNext("li"));)if(i=j,i.hasClass("tl_folder")){h=!0;break}h?g.inject(i,"before"):g.inject(i,"after")}g.getElements("a").each(function(a){a.href=a.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)}),$(a).store("tip:title",Contao.lang.collapse),f.src=AjaxRequest.themePath+"folMinus.gif",window.fireEvent("structure"),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"loadStructure",id:b,level:c,state:1,REQUEST_TOKEN:Contao.request_token}),!1)},toggleFileManager:function(a,b,c,d){a.blur();var e=$(b),f=$(a).getFirst("img");return e?("none"==e.getStyle("display")?(e.setStyle("display",null),f.src=AjaxRequest.themePath+"folMinus.gif",$(a).store("tip:title",Contao.lang.collapse),new Request.Contao({field:a}).post({action:"toggleFileManager",id:b,state:1,REQUEST_TOKEN:Contao.request_token})):(e.setStyle("display","none"),f.src=AjaxRequest.themePath+"folPlus.gif",$(a).store("tip:title",Contao.lang.expand),new Request.Contao({field:a}).post({action:"toggleFileManager",id:b,state:0,REQUEST_TOKEN:Contao.request_token})),!1):(new Request.Contao({field:a,evalScripts:!0,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(c){var e=new Element("li",{id:b,"class":"parent",styles:{display:"inline"}});new Element("ul",{"class":"level_"+d,html:c}).inject(e,"bottom"),e.inject($(a).getParent("li"),"after"),e.getElements("a").each(function(a){a.href=a.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)}),$(a).store("tip:title",Contao.lang.collapse),f.src=AjaxRequest.themePath+"folMinus.gif",AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"loadFileManager",id:b,level:d,folder:c,state:1,REQUEST_TOKEN:Contao.request_token}),!1)},togglePagetree:function(a,b,c,d,e){a.blur(),Backend.getScrollOffset();var f=$(b),g=$(a).getFirst("img");return f?("none"==f.getStyle("display")?(f.setStyle("display",null),g.src=AjaxRequest.themePath+"folMinus.gif",$(a).store("tip:title",Contao.lang.collapse),new Request.Contao({field:a}).post({action:"togglePagetree",id:b,state:1,REQUEST_TOKEN:Contao.request_token})):(f.setStyle("display","none"),g.src=AjaxRequest.themePath+"folPlus.gif",$(a).store("tip:title",Contao.lang.expand),new Request.Contao({field:a}).post({action:"togglePagetree",id:b,state:0,REQUEST_TOKEN:Contao.request_token})),!1):(new Request.Contao({field:a,evalScripts:!0,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(c){var d=new Element("li",{id:b,"class":"parent",styles:{display:"inline"}});new Element("ul",{"class":"level_"+e,html:c}).inject(d,"bottom"),d.inject($(a).getParent("li"),"after"),d.getElements("a").each(function(a){a.href=a.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)}),$(a).store("tip:title",Contao.lang.collapse),g.src=AjaxRequest.themePath+"folMinus.gif",AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"loadPagetree",id:b,level:e,field:c,name:d,state:1,REQUEST_TOKEN:Contao.request_token}),!1)},toggleFiletree:function(a,b,c,d,e,f){a.blur(),Backend.getScrollOffset();var g=$(b),h=$(a).getFirst("img");return g?("none"==g.getStyle("display")?(g.setStyle("display",null),h.src=AjaxRequest.themePath+"folMinus.gif",$(a).store("tip:title",Contao.lang.collapse),new Request.Contao({field:a}).post({action:"toggleFiletree",id:b,state:1,REQUEST_TOKEN:Contao.request_token})):(g.setStyle("display","none"),h.src=AjaxRequest.themePath+"folPlus.gif",$(a).store("tip:title",Contao.lang.expand),new Request.Contao({field:a}).post({action:"toggleFiletree",id:b,state:0,REQUEST_TOKEN:Contao.request_token})),!1):(new Request.Contao({field:a,evalScripts:!0,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(c){var d=new Element("li",{id:b,"class":"parent",styles:{display:"inline"}});new Element("ul",{"class":"level_"+f,html:c}).inject(d,"bottom"),d.inject($(a).getParent("li"),"after"),d.getElements("a").each(function(a){a.href=a.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)}),$(a).store("tip:title",Contao.lang.collapse),h.src=AjaxRequest.themePath+"folMinus.gif",AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:"loadFiletree",id:b,folder:c,level:f,field:d,name:e,state:1,REQUEST_TOKEN:Contao.request_token}),!1)},toggleSubpalette:function(a,b,c){a.blur();var d=$(b);return d?void(a.value?(a.value="",a.checked="",d.setStyle("display","none"),d.getElements("[required]").each(function(a){a.set("required",null).set("data-required","")}),new Request.Contao({field:a}).post({action:"toggleSubpalette",id:b,field:c,state:0,REQUEST_TOKEN:Contao.request_token})):(a.value=1,a.checked="checked",d.setStyle("display",null),d.getElements("[data-required]").each(function(a){a.set("required","").set("data-required",null)}),new Request.Contao({field:a}).post({action:"toggleSubpalette",id:b,field:c,state:1,REQUEST_TOKEN:Contao.request_token}))):void new Request.Contao({field:a,evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(c,d){var e=new Element("div",{id:b,html:c,styles:{display:"block"}}).inject($(a).getParent("div").getParent("div"),"after");d.javascript&&(document.write=function(a){var b="";a.replace(/<script src="([^"]+)"/i,function(a,c){b=c}),b&&Asset.javascript(b,{onLoad:function(){Browser.exec(d.javascript)}})},Browser.exec(d.javascript)),a.value=1,a.checked="checked",e.getElements("a").each(function(a){a.href=a.href.replace(/&ref=[a-f0-9]+/,"&ref="+Contao.referer_id)}),AjaxRequest.hideBox(),window.fireEvent("subpalette"),window.fireEvent("ajax_change")}}).post({action:"toggleSubpalette",id:b,field:c,load:1,state:1,REQUEST_TOKEN:Contao.request_token})},toggleVisibility:function(a,b,c){a.blur();var h,i,j,k,l,d=null,e=$(a).getFirst("img"),f=1==e.get("data-state"),g=a.getParent("div");return null===e.get("data-state")&&(f=-1==e.src.indexOf("invisible"),console.warn('Using a visibility toggle without a "data-state" attribute is deprecated. Please adjust your Contao DCA file.')),g.hasClass("tl_right")?d=g.getPrevious("div").getElement("img"):g.hasClass("tl_listing_container")?(d=a.getParent("td").getPrevious("td").getFirst("div.list_icon"),null===d&&(d=a.getParent("td").getPrevious("td").getElement("div.cte_type")),null===d&&(d=a.getParent("tr").getFirst("td").getElement("div.list_icon_new"))):(i=g.getNext("div"))&&(i.hasClass("cte_type")&&(d=i),null===d&&(d=i.getFirst("div.list_icon"))),null!==d&&("img"==d.nodeName.toLowerCase()?d.getParent("ul.tl_listing").hasClass("tl_tree_xtnd")?(j=d.get("data-icon"),k=d.get("data-icon-disabled"),null===j&&(j=d.src.replace(/(.*)\/([a-z0-9]+)_?\.(gif|png|jpe?g|svg)$/,"$1/$2.$3"),console.warn('Using a row icon without a "data-icon" attribute is deprecated. Please adjust your Contao DCA file.')),null===k&&(k=d.src.replace(/(.*)\/([a-z0-9]+)_?\.(gif|png|jpe?g|svg)$/,"$1/$2_.$3"),console.warn('Using a row icon without a "data-icon-disabled" attribute is deprecated. Please adjust your Contao DCA file.')),-1==j.indexOf("/")&&(j=AjaxRequest.themePath+j),-1==k.indexOf("/")&&(k=AjaxRequest.themePath+k),d.src=f?k:j):(l=d.getParent("a"),l&&-1==l.href.indexOf("do=feRedirect")&&(d=(i=l.getNext("a"))?i.getFirst("img"):new Element("img")),j=d.get("data-icon"),k=d.get("data-icon-disabled"),null===j&&(h=d.src.replace(/.*_([0-9])\.(gif|png|jpe?g|svg)/,"$1"),j=d.src.replace(/_[0-9]\.(gif|png|jpe?g|svg)/,(1==h.toInt()?"":"_"+(h.toInt()-1))+".$1").split(/[\\/]/).pop(),console.warn('Using a row icon without a "data-icon" attribute is deprecated. Please adjust your Contao DCA file.')),null===k&&(h=d.src.replace(/.*_([0-9])\.(gif|png|jpe?g|svg)/,"$1"),k=d.src.replace(/(_[0-9])?\.(gif|png|jpe?g|svg)/,(h==d.src?"_1":"_"+(h.toInt()+1))+".$2").split(/[\\/]/).pop(),console.warn('Using a row icon without a "data-icon-disabled" attribute is deprecated. Please adjust your Contao DCA file.')),-1==j.indexOf("/")&&(j=AjaxRequest.themePath+j),-1==k.indexOf("/")&&(k=AjaxRequest.themePath+k),d.src=f?k:j):d.hasClass("cte_type")?f?(d.addClass("unpublished"),d.removeClass("published")):(d.addClass("published"),d.removeClass("unpublished")):(j=d.get("data-icon"),k=d.get("data-icon-disabled"),null===j&&(j=d.getStyle("background-image").replace(/(.*)\/([a-z0-9]+)_?\.(gif|png|jpe?g|svg)\);?$/,"$1/$2.$2"),console.warn('Using a row icon without a "data-icon" attribute is deprecated. Please adjust your Contao DCA file.')),null===k&&(k=d.getStyle("background-image").replace(/(.*)\/([a-z0-9]+)_?\.(gif|png|jpe?g|svg)\);?$/,"$1/$2_.$3"),console.warn('Using a row icon without a "data-icon-disabled" attribute is deprecated. Please adjust your Contao DCA file.')),-1==j.indexOf("/")&&(j=AjaxRequest.themePath+j),-1==k.indexOf("/")&&(k=AjaxRequest.themePath+k),d.setStyle("background-image","url("+(f?k:j)+")"))),"tl_style"==c&&g.getParent("div").getElement("pre").toggleClass("disabled"),f?(e.src=AjaxRequest.themePath+"invisible.gif",e.set("data-state",0),new Request.Contao({url:window.location.href,followRedirects:!1}).get({tid:b,state:0,rt:Contao.request_token})):(e.src=AjaxRequest.themePath+"visible.gif",e.set("data-state",1),new Request.Contao({url:window.location.href,followRedirects:!1}).get({tid:b,state:1,rt:Contao.request_token})),!1},toggleFeatured:function(a,b){a.blur();var c=$(a).getFirst("img"),d=1==c.get("data-state");return null===c.get("data-state")&&(d=-1==c.src.indexOf("featured_"),console.warn('Using a featured toggle without a "data-state" attribute is deprecated. Please adjust your Contao DCA file.')),d?(c.src=AjaxRequest.themePath+"featured_.gif",c.set("data-state",0),(new Request.Contao).post({action:"toggleFeatured",id:b,state:0,REQUEST_TOKEN:Contao.request_token})):(c.src=AjaxRequest.themePath+"featured.gif",c.set("data-state",1),(new Request.Contao).post({action:"toggleFeatured",id:b,state:1,REQUEST_TOKEN:Contao.request_token})),!1},toggleFieldset:function(a,b,c){a.blur();var d=$("pal_"+b);if(d.hasClass("collapsed"))d.removeClass("collapsed"),(new Request.Contao).post({action:"toggleFieldset",id:b,table:c,state:1,REQUEST_TOKEN:Contao.request_token});else{for(var e=d.getParent("form"),f=d.getElements("[required]"),g=!0,h=0;h<f.length;h++)if(!f[h].get("value")){g=!1;break}g?(d.addClass("collapsed"),(new Request.Contao).post({action:"toggleFieldset",id:b,table:c,state:0,REQUEST_TOKEN:Contao.request_token})):"function"==typeof e.checkValidity&&e.getElement('input[type="submit"]').click()}return!1},toggleCheckboxGroup:function(a,b){a.blur();var c=$(b),d=$(a).getFirst("img");return c?("none"==c.getStyle("display")?(c.setStyle("display",null),d.src=AjaxRequest.themePath+"folMinus.gif",(new Request.Contao).post({action:"toggleCheckboxGroup",id:b,state:1,REQUEST_TOKEN:Contao.request_token})):(c.setStyle("display","none"),d.src=AjaxRequest.themePath+"folPlus.gif",(new Request.Contao).post({action:"toggleCheckboxGroup",id:b,state:0,REQUEST_TOKEN:Contao.request_token})),!0):!1},liveUpdate:function(a,b){var c=$(b);c&&new Request.Contao({onRequest:$("lu_message").set("html",'<p class="tl_info">Connecting to the Live Update server</p>'),onSuccess:function(b,c){b?$("lu_message").set("html",c.content):$(a).submit()}}).post({action:"liveUpdate",id:c.value,REQUEST_TOKEN:Contao.request_token})},displayBox:function(a){var b=$("tl_ajaxBox"),c=$("tl_ajaxOverlay"),d=window.getScroll();null===c&&(c=new Element("div",{id:"tl_ajaxOverlay"}).inject($(document.body),"bottom")),c.set({styles:{display:"block",top:d.y+"px"}}),null===b&&(b=new Element("div",{id:"tl_ajaxBox"}).inject($(document.body),"bottom")),b.set({html:a,styles:{display:"block",top:d.y+100+"px"}})},hideBox:function(){var a=$("tl_ajaxBox"),b=$("tl_ajaxOverlay");b&&b.setStyle("display","none"),a&&a.setStyle("display","none")}},Backend={currentId:null,xMousePosition:0,yMousePosition:0,popupWindow:null,themePath:Contao.script_url+"system/themes/"+Contao.theme+"/images/",getMousePosition:function(a){Backend.xMousePosition=a.client.x,Backend.yMousePosition=a.client.y},openWindow:function(a,b,c){a.blur(),b=Browser.ie?b+40:b+17,c=Browser.ie?c+30:c+17,Backend.popupWindow=window.open(a.href,"","width="+b+",height="+c+",modal=yes,left=100,top=50,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no")},openModalWindow:function(a,b,c){new SimpleModal({width:a,hideFooter:!0,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}}).show({title:b,contents:c})},openModalImage:function(a){var b=a||{},c=new SimpleModal({width:b.width,hideFooter:!0,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});c.show({title:b.title,contents:'<img src="'+b.url+'" alt="">'})},openModalIframe:function(a){var b=a||{},c=(window.getSize().y-180).toInt();(!b.height||b.height>c)&&(b.height=c);var d=new SimpleModal({width:b.width,hideFooter:!0,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});d.show({title:b.title,contents:'<iframe src="'+b.url+'" width="100%" height="'+b.height+'" frameborder="0"></iframe>'})},openModalSelector:function(a){var b=a||{},c=(window.getSize().y-180).toInt();(!b.height||b.height>c)&&(b.height=c);var d=new SimpleModal({width:b.width,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});d.addButton(Contao.lang.close,"btn",function(){this.hide()}),d.addButton(Contao.lang.apply,"btn primary",function(){var d,e,f,a=window.frames["simple-modal-iframe"],c=[];if(void 0===a)return void alert("Could not find the SimpleModal frame");if(-1!=a.document.location.href.indexOf("contao/main.php"))return void alert(Contao.lang.picker);for(d=a.document.getElementById("tl_select").getElementsByTagName("input"),f=0;f<d.length;f++)d[f].checked&&!d[f].id.match(/^check_all_/)&&(d[f].id.match(/^reset_/)||c.push(d[f].get("value")));if(b.tag)$(b.tag).value=c.join(","),-1!=a.document.location.href.indexOf("contao/page.php")&&($(b.tag).value="{{link_url::"+$(b.tag).value+"}}"),b.self.set("href",b.self.get("href").replace(/&value=[^&]*/,"&value="+c.join(",")));else{e=$("ctrl_"+b.id),e.value=c.join("	");var g=-1!=a.document.location.href.indexOf("contao/page.php")?"reloadPagetree":"reloadFiletree";new Request.Contao({field:e,evalScripts:!1,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" \u2026"),onSuccess:function(a,c){$("ctrl_"+b.id).getParent("div").set("html",c.content),c.javascript&&Browser.exec(c.javascript),AjaxRequest.hideBox(),window.fireEvent("ajax_change")}}).post({action:g,name:b.id,value:e.value,REQUEST_TOKEN:Contao.request_token})}this.hide()}),d.show({title:b.title,contents:'<iframe src="'+b.url+'" name="simple-modal-iframe" width="100%" height="'+b.height+'" frameborder="0"></iframe>',model:"modal"})},openModalBrowser:function(a,b,c,d){var e="file.php",f="file"==c?"&amp;switch=1":"",g=-1!=b.indexOf("{{link_url::");"file"!=c||""!=b&&!g||(e="page.php"),g&&(b=b.replace(/^\{\{link_url::([0-9]+)}}$/,"$1"));var h=new SimpleModal({width:768,btn_ok:Contao.lang.close,draggable:!1,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});h.addButton(Contao.lang.close,"btn",function(){this.hide()}),h.addButton(Contao.lang.apply,"btn primary",function(){var c,e,f,b=window.frames["simple-modal-iframe"];if(void 0===b)return void alert("Could not find the SimpleModal frame");for(e=b.document.getElementById("tl_select").getElementsByTagName("input"),f=0;f<e.length;f++)if(e[f].checked&&!e[f].id.match(/^reset_/)){c=e[f].get("value");break}isNaN(c)||(c="{{link_url::"+c+"}}"),d.document.getElementById(a).value=c,this.hide()}),h.show({title:d.document.getElement("div.mce-title").get("text"),contents:'<iframe src="contao/'+e+"?table=tl_content&amp;field=singleSRC&amp;value="+encodeURIComponent(b)+f+'" name="simple-modal-iframe" width="100%" height="'+(window.getSize().y-180).toInt()+'" frameborder="0"></iframe>',model:"modal"})},getScrollOffset:function(){document.cookie="BE_PAGE_OFFSET="+window.getScroll().y+"; path="+(Contao.path||"/")},autoSubmit:function(a){Backend.getScrollOffset();var b=new Element("input",{type:"hidden",name:"SUBMIT_TYPE",value:"auto"}),c=$(a)||a;b.inject(c,"bottom"),c.submit()},vScrollTo:function(a){window.addEvent("load",function(){window.scrollTo(null,parseInt(a))})},limitPreviewHeight:function(){var a=0;$$("div.limit_height").each(function(b){var c,d,e;if(0===a&&(a=b.className.replace(/[^0-9]*/,"").toInt()),a){if(c=new Element("img",{"class":"limit_toggler",alt:"",title:Contao.lang.expand,width:20,height:24,"data-state":0}),d=b.getCoordinates(),new Tips.Contao(c,{offset:{x:0,y:30}}),b.setStyle("height",a),d.height<=a)return c.src=Backend.themePath+"expand_.gif",void c.inject(b,"after");c.src=Backend.themePath+"expand.gif",c.setStyle("cursor","pointer"),c.addEvent("click",function(){e=this.getPrevious("div").getStyle("height").toInt(),c.getPrevious("div").setStyle("height",e>a?a:""),0==c.get("data-state")?(c.src=Backend.themePath+"collapse.gif",c.set("data-state",1),c.store("tip:title",Contao.lang.collapse)):(c.src=Backend.themePath+"expand.gif",c.set("data-state",0),c.store("tip:title",Contao.lang.expand))}),c.inject(b,"after")}})},toggleCheckboxes:function(a,b){for(var c=$$("input"),d=$(a).checked?"checked":"",e=0;e<c.length;e++)"checkbox"==c[e].type.toLowerCase()&&(b&&c[e].id.substr(0,b.length)!=b||(c[e].checked=d))},toggleCheckboxGroup:function(a,b){var c=$(a).className,d=$(a).checked?"checked":"";if("tl_checkbox"==c){var e=$(b)?$$("#"+b+" .tl_checkbox"):$(a).getParent("fieldset").getElements(".tl_checkbox");e.each(function(a){a.checked=d})}else"tl_tree_checkbox"==c&&$$("#"+b+" .parent .tl_tree_checkbox").each(function(a){a.checked=d});Backend.getScrollOffset()},toggleCheckboxElements:function(a,b){var c=$(a).checked?"checked":"";$$("."+b).each(function(a){a.hasClass("tl_checkbox")&&(a.checked=c)}),Backend.getScrollOffset()},toggleWrap:function(a){var b=$(a),c="off"==b.getProperty("wrap")?"soft":"off";b.setProperty("wrap",c)},toggleUnchanged:function(){$$("#result-list .tl_confirm").each(function(a){a.toggleClass("hidden")})},blink:function(){},addColorPicker:function(){return!0},pickPage:function(a){var b=320,c=112;Backend.currentId=a,Backend.ppValue=$(a).value,Backend.getScrollOffset(),window.open($$("base")[0].href+"contao/page.php?value="+Backend.ppValue,"","width="+b+",height="+c+",modal=yes,left="+(Backend.xMousePosition?Backend.xMousePosition-b/2:200)+",top="+(Backend.yMousePosition?Backend.yMousePosition-c/2+80:100)+",location=no,menubar=no,resizable=yes,scrollbars=no,status=no,toolbar=no")},pickFile:function(a,b){var c=320,d=112;Backend.currentId=a,Backend.ppValue=$(a).value,Backend.getScrollOffset(),window.open($$("base")[0].href+"contao/file.php?value="+Backend.ppValue+"&filter="+b,"","width="+c+",height="+d+",modal=yes,left="+(Backend.xMousePosition?Backend.xMousePosition-c/2:200)+",top="+(Backend.yMousePosition?Backend.yMousePosition-d/2+80:100)+",location=no,menubar=no,resizable=yes,scrollbars=no,status=no,toolbar=no")},collapsePalettes:function(){$$("fieldset.hide").each(function(a){a.addClass("collapsed")}),$$("label.error, label.mandatory").each(function(a){var b=a.getParent("fieldset");b&&b.removeClass("collapsed")})},addInteractiveHelp:function(){new Tips.Contao("p.tl_tip",{offset:{x:9,y:21},text:function(a){return a.get("html")}}),["a[title]","input[title]"].each(function(a){new Tips.Contao($$(a).filter(function(a){return""!=a.title}),{offset:{x:0,y:26}})}),$$("img[title]").filter(function(a){return""!=a.title}).each(function(a){new Tips.Contao(a,{offset:{x:0,y:"gimage"==a.get("class")?60:30}})})},makeParentViewSortable:function(a){var b=new Scroller(document.getElement("body"),{onChange:function(a,b){this.element.scrollTo(this.element.getScroll().x,b)}}),c=new Sortables(a,{constrain:!0,opacity:.6,onStart:function(){b.start()},onComplete:function(){b.stop()},onSort:function(a){var b=a.getParent("ul"),c=0;b&&b.getChildren("li").each(function(a){var b=a.getFirst("div");b&&(b.hasClass("wrapper_stop")&&c>0&&c--,b.className=b.className.replace(/(^|\s)indent[^\s]*/g,""),c>0&&b.addClass("indent").addClass("indent_"+c),b.hasClass("wrapper_start")&&c++)})},handle:".drag-handle"});c.active=!1,c.addEvent("start",function(){c.active=!0}),c.addEvent("complete",function(a){if(c.active){var b,d,e,f;a.getPrevious("li")?(b=a.get("id").replace(/li_/,""),d=a.getPrevious("li").get("id").replace(/li_/,""),e=window.location.search.replace(/id=[0-9]*/,"id="+b)+"&act=cut&mode=1&pid="+d,f=window.location.href.replace(/\?.*$/,""),new Request.Contao({url:f+e,followRedirects:!1}).get()):a.getParent("ul")&&(b=a.get("id").replace(/li_/,""),d=a.getParent("ul").get("id").replace(/ul_/,""),e=window.location.search.replace(/id=[0-9]*/,"id="+b)+"&act=cut&mode=2&pid="+d,f=window.location.href.replace(/\?.*$/,""),new Request.Contao({url:f+e,followRedirects:!1}).get())}})},makeMultiSrcSortable:function(a,b){var c=new Sortables($(a),{constrain:!0,opacity:.6}).addEvent("complete",function(){var e,c=[],d=$(a).getChildren("li");for(e=0;e<d.length;e++)c.push(d[e].get("data-id"));$(b).value=c.join(",")});c.fireEvent("complete")},makeWizardsSortable:function(){$$(".tl_listwizard").each(function(a){new Sortables(a,{constrain:!0,opacity:.6,handle:".drag-handle"})}),$$(".tl_tablewizard").each(function(a){var b=a.getElement(".sortable");new Sortables(b,{constrain:!0,opacity:.6,handle:".drag-handle",onComplete:function(){Backend.tableWizardResort(b)}})}),$$(".tl_modulewizard").each(function(a){new Sortables(a.getElement(".sortable"),{constrain:!0,opacity:.6,handle:".drag-handle"})}),$$(".tl_optionwizard").each(function(a){new Sortables(a.getElement(".sortable"),{constrain:!0,opacity:.6,handle:".drag-handle"})}),$$(".tl_checkbox_wizard").each(function(a){var b=a.getElement(".sortable");b.hasClass("sortable-done")||(new Sortables(b,{constrain:!0,opacity:.6,handle:".drag-handle"}),b.addClass("sortable-done"))})},listWizard:function(a,b,c){var h,i,j,k,l,d=$(c),e=$(a).getParent("li"),f=d.getChildren(),g=d.get("data-tabindex");switch(Backend.getScrollOffset(),b){case"copy":var m=e.clone(!0).inject(e,"before");(h=e.getFirst("input"))&&(m.getFirst("input").value=h.value);break;case"up":(i=e.getPrevious("li"))?e.inject(i,"before"):e.inject(d,"bottom");break;case"down":(j=e.getNext("li"))?e.inject(j,"after"):e.inject(d.getFirst("li"),"before");break;case"delete":f.length>1?e.destroy():e.getFirst("input").set("value","")}for(k=d.getChildren(),l=0;l<k.length;l++)(h=k[l].getFirst('input[type="text"]'))&&h.set("tabindex",g++);new Sortables(d,{constrain:!0,opacity:.6,handle:".drag-handle"})},tableWizard:function(a,b,c){var l,m,n,o,p,d=$(c),e=d.getElement("tbody"),f=e.getChildren(),g=$(a).getParent("td"),h=g.getParent("tr"),i=d.getElement("thead").getFirst("tr"),j=h.getChildren(),k=0;for(p=0;p<j.length&&j[p]!=g;p++)k++;switch(Backend.getScrollOffset(),b){case"rcopy":var q=new Element("tr");for(p=0;p<j.length;p++)n=j[p].clone(!0).inject(q,"bottom"),(l=j[p].getFirst("textarea"))&&(n.getFirst("textarea").value=l.value);q.inject(h,"after");break;case"rup":(m=h.getPrevious("tr"))?h.inject(m,"before"):h.inject(e,"bottom");break;case"rdown":(n=h.getNext("tr"))?h.inject(n,"after"):h.inject(e,"top");break;case"rdelete":f.length>1?h.destroy():h.getElements("textarea").set("text","");break;case"ccopy":for(p=0;p<f.length;p++)o=f[p].getChildren()[k],n=o.clone(!0).inject(o,"after"),(l=o.getFirst("textarea"))&&(n.getFirst("textarea").value=l.value);i.getFirst("td").clone(!0).inject(i.getLast("td"),"before");break;case"cmovel":if(k>0)for(p=0;p<f.length;p++)o=f[p].getChildren()[k],o.inject(o.getPrevious(),"before");else for(p=0;p<f.length;p++)o=f[p].getChildren()[k],o.inject(f[p].getLast(),"before");break;case"cmover":if(k<j.length-2)for(p=0;p<f.length;p++)o=f[p].getChildren()[k],o.inject(o.getNext(),"after");else for(p=0;p<f.length;p++)o=f[p].getChildren()[k],o.inject(f[p].getFirst(),"before");break;case"cdelete":if(j.length>2){for(p=0;p<f.length;p++)f[p].getChildren()[k].destroy();i.getFirst("td").destroy()}else for(p=0;p<f.length;p++)f[p].getElements("textarea").set("text","")}Backend.tableWizardResort(e),new Sortables(e,{constrain:!0,opacity:.6,handle:".drag-handle",onComplete:function(){Backend.tableWizardResort(e)}}),Backend.tableWizardResize()},tableWizardResort:function(a){var d,e,f,g,b=a.getChildren(),c=a.get("data-tabindex");for(f=0;f<b.length;f++)for(e=b[f].getChildren(),g=0;g<e.length;g++)(d=e[g].getFirst("textarea"))&&(d.set("tabindex",c++),d.name=d.name.replace(/\[[0-9]+][[0-9]+]/g,"["+f+"]["+g+"]"))},tableWizardResize:function(a){var b=Cookie.read("BE_CELL_SIZE");if(null!==b||null!==a)if(null!==a)b="",$$(".tl_tablewizard textarea").each(function(c){c.setStyle("width",(c.getStyle("width").toInt()*a).round().limit(142,284)),c.setStyle("height",(c.getStyle("height").toInt()*a).round().limit(66,132)),""==b&&(b=c.getStyle("width")+"|"+c.getStyle("height"))}),Cookie.write("BE_CELL_SIZE",b,{path:Contao.path});else if(null!==b){var c=b.split("|");$$(".tl_tablewizard textarea").each(function(a){a.setStyle("width",c[0]),a.setStyle("height",c[1])})}},moduleWizard:function(a,b,c){var i,j,k,l,m,n,d=$(c),e=d.getElement("tbody"),f=$(a).getParent("tr"),g=e.getChildren(),h=e.get("data-tabindex");switch(Backend.getScrollOffset(),b){case"copy":var o=new Element("tr");for(k=f.getChildren(),m=0;m<k.length;m++){var p=k[m].clone(!0).inject(o,"bottom");(j=k[m].getFirst("select"))&&(p.getFirst("select").value=j.value)}o.inject(f,"after"),o.getElement(".chzn-container").destroy(),o.getElement(".tl_select_column").destroy(),new Chosen(o.getElement("select.tl_select")),Stylect.convertSelects(),Backend.convertEnableModules();break;case"up":(o=f.getPrevious("tr"))?f.inject(o,"before"):f.inject(e,"bottom");break;case"down":(o=f.getNext("tr"))?f.inject(o,"after"):f.inject(e,"top");break;case"delete":g.length>1&&f.destroy()}for(g=e.getChildren(),m=0;m<g.length;m++)for(k=g[m].getChildren(),n=0;n<k.length;n++)(l=k[n].getFirst("a.chzn-single"))&&l.set("tabindex",h++),(j=k[n].getFirst("select"))&&(j.name=j.name.replace(/\[[0-9]+]/g,"["+m+"]")),(i=k[n].getFirst('input[type="checkbox"]'))&&(i.set("tabindex",h++),i.name=i.name.replace(/\[[0-9]+]/g,"["+m+"]"));new Sortables(e,{constrain:!0,opacity:.6,handle:".drag-handle"})},optionsWizard:function(a,b,c){var i,j,k,l,d=$(c),e=d.getElement("tbody"),f=$(a).getParent("tr"),g=e.getChildren(),h=e.get("data-tabindex");switch(Backend.getScrollOffset(),b){case"copy":var m=new Element("tr");for(j=f.getChildren(),k=0;k<j.length;k++){var n=j[k].clone(!0).inject(m,"bottom");(i=j[k].getFirst("input"))&&(n.getFirst("input").value=i.value,"checkbox"==i.type&&(n.getFirst("input").checked=i.checked?"checked":""))}m.inject(f,"after");break;case"up":(m=f.getPrevious("tr"))?f.inject(m,"before"):f.inject(e,"bottom");break;case"down":(m=f.getNext("tr"))?f.inject(m,"after"):f.inject(e,"top");break;case"delete":g.length>1&&f.destroy()}for(g=e.getChildren(),k=0;k<g.length;k++)for(j=g[k].getChildren(),l=0;l<j.length;l++)(i=j[l].getFirst("input"))&&(i.set("tabindex",h++),i.name=i.name.replace(/\[[0-9]+]/g,"["+k+"]"),"checkbox"==i.type&&(i.id=i.name.replace(/\[[0-9]+]/g,"").replace(/\[/g,"_").replace(/]/g,"")+"_"+k,i.getNext("label").set("for",i.id)));new Sortables(e,{constrain:!0,opacity:.6,handle:".drag-handle"})},keyValueWizard:function(a,b,c){var i,j,k,l,d=$(c),e=d.getElement("tbody"),f=$(a).getParent("tr"),g=e.getChildren(),h=e.get("data-tabindex");switch(Backend.getScrollOffset(),b){case"copy":var m=new Element("tr");for(j=f.getChildren(),k=0;k<j.length;k++){var n=j[k].clone(!0).inject(m,"bottom");(i=j[k].getFirst("input"))&&(n.getFirst().value=i.value)}m.inject(f,"after");break;case"up":(m=f.getPrevious("tr"))?f.inject(m,"before"):f.inject(e,"bottom");break;case"down":(m=f.getNext("tr"))?f.inject(m,"after"):f.inject(e,"top");break;case"delete":g.length>1&&f.destroy()}for(g=e.getChildren(),k=0;k<g.length;k++)for(j=g[k].getChildren(),l=0;l<j.length;l++)(i=j[l].getFirst("input"))&&(i.set("tabindex",h++),i.name=i.name.replace(/\[[0-9]+]/g,"["+k+"]"));new Sortables(e,{constrain:!0,opacity:.6,handle:".drag-handle"})},checkboxWizard:function(a,b,c){var f,d=$(c).getElement(".sortable"),e=$(a).getParent("span");switch(Backend.getScrollOffset(),b){case"up":(f=e.getPrevious("span"))?e.inject(f,"before"):e.inject(d,"bottom");break;case"down":(f=e.getNext("span"))?e.inject(f,"after"):e.inject(d,"top")}},metaWizard:function(a,b){var c=a.getParent("div").getElement("select");if(""!=c.value){var d=$(b).getLast("li").clone(),e=d.getElement("span"),f=e.getElement("img");d.setProperty("data-language",c.value),e.set("text",c.options[c.selectedIndex].text+" "),f.inject(e,"bottom"),d.getElements("input").each(function(a){a.value="",a.name=a.name.replace(/\[[a-z]{2}(_[A-Z]{2})?]/,"["+c.value+"]");var b=a.getPrevious("label"),d=parseInt(b.get("for").replace(/ctrl_[^_]+_/,""));b.set("for",b.get("for").replace(d,d+1)),a.id=b.get("for")}),d.className="even"==d.className?"odd":"even",d.inject($(b),"bottom"),a.getParent("div").getElement('input[type="button"]').setProperty("disabled",!0),c.options[c.selectedIndex].setProperty("disabled",!0),c.value="",c.fireEvent("liszt:updated")}},metaDelete:function(a){var b=a.getParent("li"),c=a.getParent("div").getElement("select");null===b.getPrevious()&&null===b.getNext()?b.getElements("input").each(function(a){a.value=""}):(c.getElement("option[value="+b.getProperty("data-language")+"]").removeProperty("disabled"),b.destroy(),c.fireEvent("liszt:updated"))},toggleAddLanguageButton:function(a){var b=a.getParent("div").getElement('input[type="button"]');
    ""!=a.value?b.removeProperty("disabled"):b.setProperty("disabled",!0)},updateModuleLink:function(a){var b=a.getParent("tr").getLast("td"),c=b.getElement("a.module_link");c.href=c.href.replace(/id=[0-9]+/,"id="+a.value),a.value>0?(b.getElement("a.module_link").setStyle("display",null),b.getElement("img.module_image").setStyle("display","none")):(b.getElement("a.module_link").setStyle("display","none"),b.getElement("img.module_image").setStyle("display",null))},convertEnableModules:function(){$$("img.mw_enable").filter(function(a){return!a.hasEvent("click")}).each(function(a){a.addEvent("click",function(){Backend.getScrollOffset();var b=a.getNext("input");b.checked?(b.checked="",a.src=Backend.themePath+"invisible.gif"):(b.checked="checked",a.src=Backend.themePath+"visible.gif")})})},enableImageSizeWidgets:function(){$$(".tl_image_size").each(function(a){var b=a.getElement("select"),c=a.getChildren("input")[0],d=a.getChildren("input")[1],e=function(){if(""===b.get("value")||b.get("value").toInt().toString()===b.get("value")){c.readOnly=!0,d.readOnly=!0;var a=$(b.getSelected()[0]).get("text");a=a.split("(").length>1?a.split("(").getLast().split(")")[0].split("x"):["",""],c.set("value","").set("placeholder",1*a[0]||""),d.set("value","").set("placeholder",1*a[1]||"")}else c.set("placeholder",""),d.set("placeholder",""),c.readOnly=!1,d.readOnly=!1};e(),b.addEvent("change",e),b.addEvent("keyup",e)})},enableToggleSelect:function(){var c,d,e,f,g,h,a=$("tl_select"),b=[],i=function(a){for(d=b.indexOf(a),e=b.indexOf(c),g=Math.min(d,e),h=Math.max(d,e),f=b[e].checked?!0:!1,g;h>=g;g++)b[g].checked=f};a&&(b=a.getElements('input[type="checkbox"]')),$$(".toggle_select").each(function(a){a.addEvent("click",function(b){var d=$(a).getElement('input[type="checkbox"],input[type="radio"]');if(d){if("radio"==d.type)return void(d.checked||(d.checked="checked"));b.shift&&c?i(d):(d.checked=d.checked?"":"checked","Backend.toggleCheckboxes(this)"==d.get("onclick")&&Backend.toggleCheckboxes(d)),c=d}})}),b.each(function(a){a.addEvent("click",function(a){a.shift&&c&&i(this),c=this})})},autoFocusFirstInputField:function(){var a=document.id("main").getElement(".tl_formbody_edit");if(null!==a){var b=a.getElements("input, textarea").filter(function(a){return!a.get("disabled")&&a.isVisible()&&"submit"!==a.get("type")&&"image"!==a.get("type")});b[0]&&b[0].focus()}},editPreviewWizard:function(a){a=$(a);var g,h,b=a.getElement("img"),c={},d=!1,e=a.get("data-original-width"),f=a.get("data-original-height"),i=function(){return b.getComputedSize().width/e},j=function(){var a=i(),d=b.getComputedSize();g.setStyles({top:d.computedTop+(c.y.get("value")*a).round()+"px",left:d.computedLeft+(c.x.get("value")*a).round()+"px",width:(c.width.get("value")*a).round()+"px",height:(c.height.get("value")*a).round()+"px"}),c.width.get("value").toInt()&&c.height.get("value").toInt()?g.setStyle("display",null):g.setStyle("display","none")},k=function(){var a=i(),d=g.getStyles("top","left","width","height"),h=b.getComputedSize(),j={x:Math.max(0,Math.min(e,(d.left.toFloat()-h.computedLeft)/a)).round(),y:Math.max(0,Math.min(f,(d.top.toFloat()-h.computedTop)/a)).round()};j.width=Math.min(e-j.x,d.width.toFloat()/a).round(),j.height=Math.min(f-j.y,d.height.toFloat()/a).round(),j.width&&j.height?g.setStyle("display",null):(j.x=j.y=j.width=j.height="",g.setStyle("display","none")),Object.each(j,function(a,b){c[b].set("value",a)})},l=function(c){c.preventDefault(),d||(d=!0,h={x:c.page.x-a.getPosition().x-b.getComputedSize().computedLeft,y:c.page.y-a.getPosition().y-b.getComputedSize().computedTop},m(c))},m=function(c){if(d){c.preventDefault();var e=b.getComputedSize(),f={x:[Math.max(0,Math.min(e.width,h.x)),Math.max(0,Math.min(e.width,c.page.x-a.getPosition().x-e.computedLeft))],y:[Math.max(0,Math.min(e.height,h.y)),Math.max(0,Math.min(e.height,c.page.y-a.getPosition().y-e.computedTop))]};g.setStyles({top:Math.min(f.y[0],f.y[1])+e.computedTop+"px",left:Math.min(f.x[0],f.x[1])+e.computedLeft+"px",width:Math.abs(f.x[0]-f.x[1])+"px",height:Math.abs(f.y[0]-f.y[1])+"px"}),k()}},n=function(a){m(a),d=!1},o=function(){a.getParent().getElements('input[name^="importantPart"]').each(function(a){["x","y","width","height"].each(function(b){a.get("name").substr(13,b.length)===b.capitalize()&&(c[b]=a=$(a))})}),4===Object.getLength(c)&&(Object.each(c,function(a){a.getParent().setStyle("display","none")}),a.addClass("tl_edit_preview_enabled"),g=new Element("div",{"class":"tl_edit_preview_important_part"}).inject(a),j(),b.addEvent("load",j),a.addEvents({mousedown:l,touchstart:l}),$(document.documentElement).addEvents({mousemove:m,touchmove:m,mouseup:n,touchend:n,touchcancel:n,resize:j}))};window.addEvent("domready",o)}};document.addEvent("mousedown",function(a){Backend.getMousePosition(a)}),window.addEvent("domready",function(){$(document.body).addClass("js"),Browser.Features.Touch&&$(document.body).addClass("touch"),Backend.collapsePalettes(),Backend.addInteractiveHelp(),Backend.convertEnableModules(),Backend.makeWizardsSortable(),Backend.enableImageSizeWidgets(),Backend.enableToggleSelect(),Backend.autoFocusFirstInputField(),void 0!=Elements.chosen&&$$("select.tl_chosen").chosen(),$$("textarea.monospace").each(function(a){Backend.toggleWrap(a)})}),window.addEvent("load",function(){Backend.limitPreviewHeight()}),window.addEvent("ajax_change",function(){Backend.addInteractiveHelp(),Backend.makeWizardsSortable(),Backend.enableImageSizeWidgets(),Backend.enableToggleSelect(),void 0!=Elements.chosen&&$$("select.tl_chosen").filter(function(a){return"none"!=a.getStyle("display")}).chosen()});
