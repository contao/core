/* Swipe 2.0, (C) Brad Birdsall 2012, MIT license */
function Swipe(e,t){"use strict";function m(){o=s.children,f=o.length,o.length<2&&(t.continuous=!1),i.transitions&&t.continuous&&o.length<3&&(s.appendChild(o[0].cloneNode(!0)),s.appendChild(s.children[1].cloneNode(!0)),o=s.children,h=!0),u=new Array(o.length),a=e.getBoundingClientRect().width||e.offsetWidth,s.style.width=o.length*a+"px";var n=o.length;while(n--){var r=o[n];r.style.width=a+"px",r.setAttribute("data-index",n),i.transitions&&(r.style.left=n*-a+"px",k(n,l>n?-a:l<n?a:0,0))}t.continuous&&i.transitions&&(k(N(l-1),-a,0),k(N(l+1),a,0)),i.transitions||(s.style.left=l*-a+"px"),e.style.visibility="visible"}function g(e,t,n){i.addEventListener?e.addEventListener(t,n,!1):window.attachEvent&&e.attachEvent("on"+t,n)}function y(e){e.returnValue=!1,e.preventDefault&&e.preventDefault()}function b(e,t,n){i.addEventListener?e.removeEventListener(t,n,!1):window.detachEvent&&e.detachEvent("on"+t,n)}function w(){var e=t.menu.childNodes;for(var n=0;n<e.length;n++)if(e[n].className&&e[n].className.indexOf("slider-prev")!=-1)v.prev=function(e){y(e),D(),x()},d.prev=e[n],g(d.prev,"click",v.prev);else if(e[n].className&&e[n].className.indexOf("slider-next")!=-1)v.next=function(e){y(e),D(),T()},d.next=e[n],g(d.next,"click",v.next);else if(e[n].className&&e[n].className.indexOf("slider-menu")!=-1){for(var r=0;r<f;r++){var i=document.createElement("b");i.innerHTML="â€¢",i.setAttribute("data-index",r),r==c&&(i.className="active"),g(i,"click",function(e){return function(t){y(t),D(),C(parseInt(this.getAttribute?this.getAttribute("data-index"):e.attributes["data-index"].nodeValue))}}(i)),e[n].appendChild(i)}d.dots=e[n]}}function E(){for(var e=0;e<f;e++){var t=d.dots.children[e];t.className=parseInt(t.getAttribute?t.getAttribute("data-index"):t.attributes["data-index"].nodeValue)==c?"active":""}}function S(){var e=d.dots.childNodes;while(e.length>0)d.dots.removeChild(e[0]);b(d.prev,"click",v.prev),b(d.next,"click",v.next)}function x(){t.continuous?C(l-1):l&&C(l-1)}function T(){t.continuous?C(l+1):l<o.length-1&&C(l+1)}function N(e){return(o.length+e%o.length)%o.length}function C(e,n){if(l==e)return;if(i.transitions){var s=Math.abs(l-e)/(l-e);if(t.continuous){var f=s;s=-u[N(e)]/a,s!==f&&(e=-s*o.length+e)}var d=Math.abs(l-e)-1;while(d--)k(N((e>l?e:l)-d-1),a*s,0);e=N(e),k(l,a*s,n||p),k(e,0,n||p),t.continuous&&k(N(e-s),-(a*s),0)}else e=N(e),A(l*-a,e*-a,n||p);l=e,c=h?l%2:l,t.menu&&E(),r(t.callback&&t.callback(c,o[l]))}function k(e,t,n){L(e,t,n),u[e]=t}function L(e,t,n){var r=o[e],i=r&&r.style;if(!i)return;i.webkitTransitionDuration=i.MozTransitionDuration=i.msTransitionDuration=i.OTransitionDuration=i.transitionDuration=n+"ms",i.webkitTransform="translate("+t+"px,0)"+"translateZ(0)",i.msTransform=i.MozTransform=i.OTransform="translateX("+t+"px)"}function A(e,n,r){if(!r){s.style.left=n+"px";return}var i=+(new Date),u=setInterval(function(){var a=+(new Date)-i;if(a>r){s.style.left=n+"px",O&&_(),t.transitionEnd&&t.transitionEnd.call(event,c,o[l]),clearInterval(u);return}s.style.left=(n-e)*(Math.floor(a/r*100)/100)+e+"px"},4)}function _(){M=setTimeout(T,O)}function D(){O=0,clearTimeout(M)}var n=function(){},r=function(e){setTimeout(e||n,0)},i={addEventListener:!!window.addEventListener,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,transitions:function(e){var t=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var n in t)if(e.style[t[n]]!==undefined)return!0;return!1}(document.createElement("swipe"))};if(!e)return;var s=e.children[0],o,u,a,f;t=t||{};var l=parseInt(t.startSlide,10)||0,c=l,h=!1,p=t.speed||300;t.continuous=t.continuous!==undefined?t.continuous:!0;var d={},v={},O=t.auto||0,M,P={},H={},B,j={handleEvent:function(e){switch(e.type){case"touchstart":this.start(e);break;case"touchmove":this.move(e);break;case"touchend":r(this.end(e));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":r(this.transitionEnd(e));break;case"resize":r(m)}t.stopPropagation&&e.stopPropagation()},start:function(e){var t=e.touches[0];P={x:t.pageX,y:t.pageY,time:+(new Date)},B=undefined,H={},s.addEventListener("touchmove",this,!1),s.addEventListener("touchend",this,!1)},move:function(e){if(e.touches.length>1||e.scale&&e.scale!==1)return;t.disableScroll&&e.preventDefault();var n=e.touches[0];H={x:n.pageX-P.x,y:n.pageY-P.y},typeof B=="undefined"&&(B=!!(B||Math.abs(H.x)<Math.abs(H.y))),B||(e.preventDefault(),D(),t.continuous?(L(N(l-1),H.x+u[N(l-1)],0),L(l,H.x+u[l],0),L(N(l+1),H.x+u[N(l+1)],0)):(H.x=H.x/(!l&&H.x>0||l==o.length-1&&H.x<0?Math.abs(H.x)/a+1:1),L(l-1,H.x+u[l-1],0),L(l,H.x+u[l],0),L(l+1,H.x+u[l+1],0)))},end:function(e){var n=+(new Date)-P.time,r=Number(n)<250&&Math.abs(H.x)>20||Math.abs(H.x)>a/2,i=!l&&H.x>0||l==o.length-1&&H.x<0;t.continuous&&(i=!1);var f=H.x<0;B||(r&&!i?(f?(t.continuous?(k(N(l-1),-a,0),k(N(l+2),a,0)):k(l-1,-a,0),k(l,u[l]-a,p),k(N(l+1),u[N(l+1)]-a,p),l=N(l+1)):(t.continuous?(k(N(l+1),a,0),k(N(l-2),-a,0)):k(l+1,a,0),k(l,u[l]+a,p),k(N(l-1),u[N(l-1)]+a,p),l=N(l-1)),c=h?l%2:l,t.menu&&E(),t.callback&&t.callback(c,o[l])):t.continuous?(k(N(l-1),-a,p),k(l,0,p),k(N(l+1),a,p)):(k(l-1,-a,p),k(l,0,p),k(l+1,a,p))),s.removeEventListener("touchmove",j,!1),s.removeEventListener("touchend",j,!1)},transitionEnd:function(e){parseInt(e.target.getAttribute("data-index"),10)==l&&(O&&_(),t.transitionEnd&&t.transitionEnd.call(e,c,o[l]))}};return m(),t.menu&&w(),O&&_(),i.addEventListener?(i.touch&&s.addEventListener("touchstart",j,!1),i.transitions&&(s.addEventListener("webkitTransitionEnd",j,!1),s.addEventListener("msTransitionEnd",j,!1),s.addEventListener("oTransitionEnd",j,!1),s.addEventListener("otransitionend",j,!1),s.addEventListener("transitionend",j,!1)),window.addEventListener("resize",j,!1)):window.onresize=function(){m()},{setup:function(){m()},slide:function(e,t){D(),C(e,t)},prev:function(){D(),x()},next:function(){D(),T()},stop:function(){D()},getPos:function(){return c},getNumSlides:function(){return f},kill:function(){D(),s.style.width="",s.style.left="";var e=o.length;while(e--){var t=o[e];t.style.width="",t.style.left="",i.transitions&&L(e,0,0)}i.addEventListener?(s.removeEventListener("touchstart",j,!1),s.removeEventListener("webkitTransitionEnd",j,!1),s.removeEventListener("msTransitionEnd",j,!1),s.removeEventListener("oTransitionEnd",j,!1),s.removeEventListener("otransitionend",j,!1),s.removeEventListener("transitionend",j,!1),window.removeEventListener("resize",j,!1)):window.onresize=null,S()}}};