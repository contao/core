/* Swipe 2.0, (C) Brad Birdsall 2012, MIT license */
function Swipe(B,u){var K=function(){};var j=function(M){setTimeout(M||K,0)};var i={addEventListener:!!window.addEventListener,touch:("ontouchstart" in window)||window.DocumentTouch&&document instanceof DocumentTouch,transitions:(function(M){var O=["transitionProperty","WebkitTransition","MozTransition","OTransition","msTransition"];for(var N in O){if(M.style[O[N]]!==undefined){return true}}return false})(document.createElement("swipe"))};if(!B){return}var p=B.children[0];var k,H,a,s;u=u||{};var z=parseInt(u.startSlide,10)||0;var E=z;var n=false;var F=u.speed||300;u.continuous=u.continuous!==undefined?u.continuous:true;var D={},G={};function m(){k=p.children;s=0;for(var O=0,N=k.length;O<N;O++){if(k[O].tagName!="!"){s++}}if(k.length<2){u.continuous=false}if(i.transitions&&u.continuous&&k.length<3){p.appendChild(k[0].cloneNode(true));p.appendChild(p.children[1].cloneNode(true));k=p.children;n=true}H=new Array(k.length);a=B.getBoundingClientRect().width||B.offsetWidth;p.style.width=(k.length*a)+"px";var P=k.length;while(P--){var M=k[P];M.style.width=a+"px";M.setAttribute("data-index",P);if(i.transitions){M.style.left=(P*-a)+"px";q(P,z>P?-a:(z<P?a:0),0)}}if(u.continuous&&i.transitions){q(t(z-1),-a,0);q(t(z+1),a,0)}if(!i.transitions){p.style.left=(z*-a)+"px"}B.style.visibility="visible"}function l(O,N,M){if(i.addEventListener){O.addEventListener(N,M,false)}else{if(window.attachEvent){O.attachEvent("on"+N,M)}}}function J(M){M.returnValue=false;M.preventDefault&&M.preventDefault()}function c(O,N,M){if(i.addEventListener){O.removeEventListener(N,M,false)}else{if(window.detachEvent){O.detachEvent("on"+N,M)}}}function L(){var P=u.menu.childNodes;for(var O=0;O<P.length;O++){if(P[O].className&&P[O].className.indexOf("slider-prev")!=-1){G.prev=function(Q){J(Q);r();x()};D.prev=P[O];l(D.prev,"click",G.prev)}else{if(P[O].className&&P[O].className.indexOf("slider-next")!=-1){G.next=function(Q){J(Q);r();g()};D.next=P[O];l(D.next,"click",G.next)}else{if(P[O].className&&P[O].className.indexOf("slider-menu")!=-1){for(var N=0;N<s;N++){var M=document.createElement("b");M.innerHTML="â€¢";M.setAttribute("data-index",N);if(N==E){M.className="active"}l(M,"click",(function(Q){return(function(R){J(R);r();b(parseInt((this.getAttribute?this.getAttribute("data-index"):Q.attributes["data-index"].nodeValue)))})})(M));P[O].appendChild(M)}D.dots=P[O]}}}}}function h(){for(var N=0,M=n?s/2:s;N<M;N++){var O=D.dots.children[N];O.className=(parseInt(O.getAttribute?O.getAttribute("data-index"):O.attributes["data-index"].nodeValue)==E)?"active":""}}function y(){var M=D.dots.childNodes;while(M.length>0){D.dots.removeChild(M[0])}c(D.prev,"click",G.prev);c(D.next,"click",G.next)}function x(){if(u.continuous){b(z-1)}else{if(z){b(z-1)}}}function g(){if(u.continuous){b(z+1)}else{if(z<k.length-1){b(z+1)}}}function t(M){return(k.length+(M%k.length))%k.length}function b(Q,N){if(z==Q){return}if(i.transitions){var P=Math.abs(z-Q)/(z-Q);if(u.continuous){var M=P;P=-H[t(Q)]/a;if(P!==M){Q=-P*k.length+Q}}var O=Math.abs(z-Q)-1;while(O--){q(t((Q>z?Q:z)-O-1),a*P,0)}Q=t(Q);q(z,a*P,N||F);q(Q,0,N||F);if(u.continuous){q(t(Q-P),-(a*P),0)}}else{Q=t(Q);I(z*-a,Q*-a,N||F)}z=Q;E=n?(z%2):z;if(u.menu){h()}j(u.callback&&u.callback(E,k[z]))}function q(M,O,N){f(M,O,N);H[M]=O}function f(N,Q,P){var M=k[N];var O=M&&M.style;if(!O){return}O.webkitTransitionDuration=O.MozTransitionDuration=O.msTransitionDuration=O.OTransitionDuration=O.transitionDuration=P+"ms";O.webkitTransform="translate("+Q+"px,0)translateZ(0)";O.msTransform=O.MozTransform=O.OTransform="translateX("+Q+"px)"}function I(Q,P,M){if(!M){p.style.left=P+"px";return}var O=+new Date;var N=setInterval(function(){var R=+new Date-O;if(R>M){p.style.left=P+"px";if(A){o()}u.transitionEnd&&u.transitionEnd.call(event,E,k[z]);clearInterval(N);return}p.style.left=(((P-Q)*(Math.floor((R/M)*100)/100))+Q)+"px"},4)}var A=u.auto||0;var e;function o(){e=setTimeout(g,A)}function r(){A=0;clearTimeout(e)}var w={};var C={};var d;var v={handleEvent:function(M){switch(M.type){case"touchstart":this.start(M);break;case"touchmove":this.move(M);break;case"touchend":j(this.end(M));break;case"webkitTransitionEnd":case"msTransitionEnd":case"oTransitionEnd":case"otransitionend":case"transitionend":j(this.transitionEnd(M));break;case"resize":j(m);break}if(u.stopPropagation){M.stopPropagation()}},start:function(M){var N=M.touches[0];w={x:N.pageX,y:N.pageY,time:+new Date};d=undefined;C={};p.addEventListener("touchmove",this,false);p.addEventListener("touchend",this,false)},move:function(M){if(M.touches.length>1||M.scale&&M.scale!==1){return}if(u.disableScroll){M.preventDefault()}var N=M.touches[0];C={x:N.pageX-w.x,y:N.pageY-w.y};if(typeof d=="undefined"){d=!!(d||Math.abs(C.x)<Math.abs(C.y))}if(!d){M.preventDefault();r();if(u.continuous){f(t(z-1),C.x+H[t(z-1)],0);f(z,C.x+H[z],0);f(t(z+1),C.x+H[t(z+1)],0)}else{C.x=C.x/((!z&&C.x>0||z==k.length-1&&C.x<0)?(Math.abs(C.x)/a+1):1);f(z-1,C.x+H[z-1],0);f(z,C.x+H[z],0);f(z+1,C.x+H[z+1],0)}}},end:function(O){var Q=+new Date-w.time;var N=Number(Q)<250&&Math.abs(C.x)>20||Math.abs(C.x)>a/2;var M=!z&&C.x>0||z==k.length-1&&C.x<0;if(u.continuous){M=false}var P=C.x<0;if(!d){if(N&&!M){if(P){if(u.continuous){q(t(z-1),-a,0);q(t(z+2),a,0)}else{q(z-1,-a,0)}q(z,H[z]-a,F);q(t(z+1),H[t(z+1)]-a,F);z=t(z+1)}else{if(u.continuous){q(t(z+1),a,0);q(t(z-2),-a,0)}else{q(z+1,a,0)}q(z,H[z]+a,F);q(t(z-1),H[t(z-1)]+a,F);z=t(z-1)}E=n?(z%2):z;if(u.menu){h()}u.callback&&u.callback(E,k[z])}else{if(u.continuous){q(t(z-1),-a,F);q(z,0,F);q(t(z+1),a,F)}else{q(z-1,-a,F);q(z,0,F);q(z+1,a,F)}}}p.removeEventListener("touchmove",v,false);p.removeEventListener("touchend",v,false)},transitionEnd:function(M){if(parseInt(M.target.getAttribute("data-index"),10)==z){if(A){o()}u.transitionEnd&&u.transitionEnd.call(M,E,k[z])}}};m();if(u.menu){L()}if(A){o()}if(i.addEventListener){if(i.touch){p.addEventListener("touchstart",v,false)}if(i.transitions){p.addEventListener("webkitTransitionEnd",v,false);p.addEventListener("msTransitionEnd",v,false);p.addEventListener("oTransitionEnd",v,false);p.addEventListener("otransitionend",v,false);p.addEventListener("transitionend",v,false)}window.addEventListener("resize",v,false)}else{window.onresize=function(){m()}}return{setup:function(){m()},slide:function(N,M){r();b(N,M)},prev:function(){r();x()},next:function(){r();g()},stop:function(){r()},getPos:function(){return E},getNumSlides:function(){return s},kill:function(){r();p.style.width="";p.style.left="";var N=k.length;while(N--){var M=k[N];M.style.width="";M.style.left="";if(i.transitions){f(N,0,0)}}if(i.addEventListener){p.removeEventListener("touchstart",v,false);p.removeEventListener("webkitTransitionEnd",v,false);p.removeEventListener("msTransitionEnd",v,false);p.removeEventListener("oTransitionEnd",v,false);p.removeEventListener("otransitionend",v,false);p.removeEventListener("transitionend",v,false);window.removeEventListener("resize",v,false)}else{window.onresize=null}y()}}};
