/* Contao Open Source CMS, (C) 2005-2012 Leo Feyer, LGPL license */
var AjaxRequest={toggleNavigation:function(a,d){a.blur();var b=$(d);var c=$(a).getFirst("img");if(b){if(b.getStyle("display")=="none"){b.setStyle("display","inline");c.src=c.src.replace("modPlus.gif","modMinus.gif");$(a).store("tip:title",Contao.lang.collapse);new Request.Contao().post({action:"toggleNavigation",id:d,state:1,REQUEST_TOKEN:Contao.request_token})}else{b.setStyle("display","none");c.src=c.src.replace("modMinus.gif","modPlus.gif");$(a).store("tip:title",Contao.lang.expand);new Request.Contao().post({action:"toggleNavigation",id:d,state:0,REQUEST_TOKEN:Contao.request_token})}return false}new Request.Contao({evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,f){b=new Element("li",{id:d,"class":"tl_parent",html:e,styles:{display:"inline"}}).inject($(a).getParent("li"),"after");$(a).store("tip:title",Contao.lang.collapse);c.src=c.src.replace("modPlus.gif","modMinus.gif");AjaxRequest.hideBox();window.fireEvent("ajax_change")}}).post({action:"loadNavigation",id:d,state:1,REQUEST_TOKEN:Contao.request_token});return false},toggleStructure:function(a,f,e,d){a.blur();var b=$(f);var c=$(a).getFirst("img");if(b){if(b.getStyle("display")=="none"){b.setStyle("display","inline");c.src=c.src.replace("folPlus.gif","folMinus.gif");$(a).store("tip:title",Contao.lang.collapse);new Request.Contao({field:a}).post({action:"toggleStructure",id:f,state:1,REQUEST_TOKEN:Contao.request_token})}else{b.setStyle("display","none");c.src=c.src.replace("folMinus.gif","folPlus.gif");$(a).store("tip:title",Contao.lang.expand);new Request.Contao({field:a}).post({action:"toggleStructure",id:f,state:0,REQUEST_TOKEN:Contao.request_token})}return false}new Request.Contao({field:a,evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(h,k){var g=new Element("li",{id:f,"class":"parent",styles:{display:"inline"}});var j=new Element("ul",{"class":"level_"+e,html:h}).inject(g,"bottom");if(d==5){g.inject($(a).getParent("li"),"after")}else{var m=false;var l=$(a).getParent("li");while(typeOf(l)=="element"&&(next=l.getNext("li"))){l=next;if(l.hasClass("tl_folder")){m=true;break}}if(m){g.inject(l,"before")}else{g.inject(l,"after")}}$(a).store("tip:title",Contao.lang.collapse);c.src=c.src.replace("folPlus.gif","folMinus.gif");window.fireEvent("structure");AjaxRequest.hideBox();window.fireEvent("ajax_change")}}).post({action:"loadStructure",id:f,level:e,state:1,REQUEST_TOKEN:Contao.request_token});return false},toggleFileManager:function(b,g,d,f){b.blur();var c=$(g);var e=$(b).getFirst("img");var a=$(b).getNext("img");if(c){if(c.getStyle("display")=="none"){c.setStyle("display","inline");e.src=e.src.replace("folPlus.gif","folMinus.gif");a.src=a.src.replace("folderC","folderO");$(b).store("tip:title",Contao.lang.collapse);new Request.Contao({field:b}).post({action:"toggleFileManager",id:g,state:1,REQUEST_TOKEN:Contao.request_token})}else{c.setStyle("display","none");e.src=e.src.replace("folMinus.gif","folPlus.gif");a.src=a.src.replace("folderO","folderC");$(b).store("tip:title",Contao.lang.expand);new Request.Contao({field:b}).post({action:"toggleFileManager",id:g,state:0,REQUEST_TOKEN:Contao.request_token})}return false}new Request.Contao({field:b,evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(j,l){var h=new Element("li",{id:g,"class":"parent",styles:{display:"inline"}});var k=new Element("ul",{"class":"level_"+f,html:j}).inject(h,"bottom");h.inject($(b).getParent("li"),"after");$(b).store("tip:title",Contao.lang.collapse);e.src=e.src.replace("folPlus.gif","folMinus.gif");a.src=a.src.replace("folderC.gif","folderO.gif");AjaxRequest.hideBox();window.fireEvent("ajax_change")}}).post({action:"loadFileManager",id:g,level:f,folder:d,state:1,REQUEST_TOKEN:Contao.request_token});return false},togglePagetree:function(b,g,e,a,f){b.blur();var c=$(g);var d=$(b).getFirst("img");if(c){if(c.getStyle("display")=="none"){c.setStyle("display","inline");d.src=d.src.replace("folPlus.gif","folMinus.gif");$(b).store("tip:title",Contao.lang.collapse);new Request.Contao({field:b}).post({action:"togglePagetree",id:g,state:1,REQUEST_TOKEN:Contao.request_token})}else{c.setStyle("display","none");d.src=d.src.replace("folMinus.gif","folPlus.gif");$(b).store("tip:title",Contao.lang.expand);new Request.Contao({field:b}).post({action:"togglePagetree",id:g,state:0,REQUEST_TOKEN:Contao.request_token})}return false}new Request.Contao({field:b,evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(j,l){var h=new Element("li",{id:g,"class":"parent",styles:{display:"inline"}});var k=new Element("ul",{"class":"level_"+f,html:j}).inject(h,"bottom");h.inject($(b).getParent("li"),"after");$(b).store("tip:title",Contao.lang.collapse);d.src=d.src.replace("folPlus.gif","folMinus.gif");AjaxRequest.hideBox();window.fireEvent("ajax_change")}}).post({action:"loadPagetree",id:g,level:f,field:e,name:a,state:1,REQUEST_TOKEN:Contao.request_token});return false},toggleFiletree:function(b,g,e,a,f){b.blur();var c=$(g);var d=$(b).getFirst("img");if(c){if(c.getStyle("display")=="none"){c.setStyle("display","inline");d.src=d.src.replace("folPlus.gif","folMinus.gif");$(b).store("tip:title",Contao.lang.collapse);new Request.Contao({field:b}).post({action:"toggleFiletree",id:g,state:1,REQUEST_TOKEN:Contao.request_token})}else{c.setStyle("display","none");d.src=d.src.replace("folMinus.gif","folPlus.gif");$(b).store("tip:title",Contao.lang.expand);new Request.Contao({field:b}).post({action:"toggleFiletree",id:g,state:0,REQUEST_TOKEN:Contao.request_token})}return false}new Request.Contao({field:b,evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(j,l){var h=new Element("li",{id:g,"class":"parent",styles:{display:"inline"}});var k=new Element("ul",{"class":"level_"+f,html:j}).inject(h,"bottom");h.inject($(b).getParent("li"),"after");$(b).store("tip:title",Contao.lang.collapse);d.src=d.src.replace("folPlus.gif","folMinus.gif");AjaxRequest.hideBox();window.fireEvent("ajax_change")}}).post({action:"loadFiletree",id:g,level:f,field:e,name:a,state:1,REQUEST_TOKEN:Contao.request_token});return false},reloadFiletrees:function(){$$(".filetree").each(function(b){var a=b.id;var c=a.replace(/_[0-9]+$/,"");new Request.Contao({evalScripts:true,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,g){var f=$(b.id+"_parent").getFirst("ul");var d=f.getLast("li");f.set("html",e);d.inject(f,"bottom");AjaxRequest.hideBox();window.fireEvent("ajax_change")}}).post({action:"loadFiletree",field:c,name:a,REQUEST_TOKEN:Contao.request_token})})},toggleSubpalette:function(a,d,c){a.blur();var b=$(d);if(b){if(!a.value){a.value=1;a.checked="checked";b.setStyle("display","block");new Request.Contao({field:a}).post({action:"toggleSubpalette",id:d,field:c,state:1,REQUEST_TOKEN:Contao.request_token})}else{a.value="";a.checked="";b.setStyle("display","none");new Request.Contao({field:a}).post({action:"toggleSubpalette",id:d,field:c,state:0,REQUEST_TOKEN:Contao.request_token})}return}new Request.Contao({field:a,evalScripts:false,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,f){var g=new Element("div",{id:d,html:e,styles:{display:"block"}}).inject($(a).getParent("div").getParent("div"),"after");if(f.javascript){$exec(f.javascript)}a.value=1;a.checked="checked";AjaxRequest.hideBox();Backend.addInteractiveHelp();Backend.addColorPicker();window.fireEvent("subpalette");window.fireEvent("ajax_change")}}).post({action:"toggleSubpalette",id:d,field:c,load:1,state:1,REQUEST_TOKEN:Contao.request_token})},toggleVisibility:function(d,h,e){d.blur();var a=null;var f=$(d).getFirst("img");var c=(f.src.indexOf("invisible")!=-1);var g=d.getParent("div");if(g.hasClass("tl_right")){a=g.getPrevious("div").getElement("img")}else{if(g.hasClass("tl_listing_container")){a=d.getParent("td").getPrevious("td").getFirst("div.list_icon");if(a==null){a=d.getParent("td").getPrevious("td").getElement("div.cte_type")}if(a==null){a=d.getParent("tr").getFirst("td").getElement("div.list_icon_new")}}else{if((next=g.getNext("div"))&&next.hasClass("cte_type")){a=next}}}if(a!=null){if(a.nodeName.toLowerCase()=="img"){if(a.getParent("ul.tl_listing").hasClass("tl_tree_xtnd")){if(c){a.src=a.src.replace(/_\.(gif|png|jpe?g)/,".$1")}else{a.src=a.src.replace(/\.(gif|png|jpe?g)/,"_.$1")}}else{if(a.src.match(/folPlus|folMinus/)){if(a.getParent("a").getNext("a")){a=a.getParent("a").getNext("a").getFirst("img")}else{a=new Element("img")}}if(c){var b=a.src.replace(/.*_([0-9])\.(gif|png|jpe?g)/,"$1");a.src=a.src.replace(/_[0-9]\.(gif|png|jpe?g)/,((b.toInt()==1)?"":"_"+(b.toInt()-1))+".$1")}else{var b=a.src.replace(/.*_([0-9])\.(gif|png|jpe?g)/,"$1");a.src=a.src.replace(/(_[0-9])?\.(gif|png|jpe?g)/,((b==a.src)?"_1":"_"+(b.toInt()+1))+".$2")}}}else{if(a.hasClass("cte_type")){if(c){a.addClass("published");a.removeClass("unpublished")}else{a.addClass("unpublished");a.removeClass("published")}}else{if(c){a.setStyle("background-image",a.getStyle("background-image").replace(/_\.(gif|png|jpe?g)/,".$1"))}else{a.setStyle("background-image",a.getStyle("background-image").replace(/\.(gif|png|jpe?g)/,"_.$1"))}}}}if(e=="tl_style"){g.getParent("div").getElement("pre").toggleClass("disabled")}if(c){f.src=f.src.replace("invisible.gif","visible.gif");new Request({url:window.location.href}).get({tid:h,state:1})}else{f.src=f.src.replace("visible.gif","invisible.gif");new Request({url:window.location.href}).get({tid:h,state:0})}return false},toggleFeatured:function(a,d){a.blur();var b=$(a).getFirst("img");var c=(b.src.indexOf("featured_")==-1);if(!c){b.src=b.src.replace("featured_.gif","featured.gif");new Request.Contao().post({action:"toggleFeatured",id:d,state:1,REQUEST_TOKEN:Contao.request_token})}else{b.src=b.src.replace("featured.gif","featured_.gif");new Request.Contao().post({action:"toggleFeatured",id:d,state:0,REQUEST_TOKEN:Contao.request_token})}return false},toggleFieldset:function(b,d,c){b.blur();var a=$("pal_"+d);if(a.hasClass("collapsed")){a.removeClass("collapsed");new Request.Contao().post({action:"toggleFieldset",id:d,table:c,state:1,REQUEST_TOKEN:Contao.request_token})}else{a.addClass("collapsed");new Request.Contao().post({action:"toggleFieldset",id:d,table:c,state:0,REQUEST_TOKEN:Contao.request_token})}return false},toggleCheckboxGroup:function(a,d){a.blur();var b=$(d);var c=$(a).getFirst("img");if(b){if(b.getStyle("display")!="block"){b.setStyle("display","block");c.src=c.src.replace("folPlus.gif","folMinus.gif");new Request.Contao().post({action:"toggleCheckboxGroup",id:d,state:1,REQUEST_TOKEN:Contao.request_token})}else{b.setStyle("display","none");c.src=c.src.replace("folMinus.gif","folPlus.gif");new Request.Contao().post({action:"toggleCheckboxGroup",id:d,state:0,REQUEST_TOKEN:Contao.request_token})}return true}return false},liveUpdate:function(b,c){var a=$(c);if(!a){return}new Request.Contao({onRequest:$("lu_message").set("html",'<p class="tl_info">Connecting to live update server</p>'),onSuccess:function(d,e){if(d){$("lu_message").set("html",e.content)}else{$(b).submit()}}}).post({action:"liveUpdate",id:a.value,REQUEST_TOKEN:Contao.request_token})},displayBox:function(d){var c=$("tl_ajaxBox");var b=$("tl_ajaxOverlay");var a=window.getScroll();if(b==null){b=new Element("div",{id:"tl_ajaxOverlay"}).inject($(document.body),"bottom")}b.set({styles:{display:"block",top:a.y+"px"}});if(c==null){c=new Element("div",{id:"tl_ajaxBox"}).inject($(document.body),"bottom")}c.set({html:d,styles:{display:"block",top:(a.y+100)+"px"}})},hideBox:function(){var b=$("tl_ajaxBox");var a=$("tl_ajaxOverlay");if(a){a.setStyle("display","none")}if(b){b.setStyle("display","none")}}};var Backend={currentId:null,xMousePosition:0,yMousePosition:0,popupWindow:null,getMousePosition:function(a){Backend.xMousePosition=a.client.x;Backend.yMousePosition=a.client.y},openWindow:function(c,b,a){c.blur();b=Browser.ie?(b+40):(b+17);a=Browser.ie?(a+30):(a+17);Backend.popupWindow=window.open(c.href,"","width="+b+",height="+a+",modal=yes,left=100,top=50,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,toolbar=no")},openModalWindow:function(a,c,b){new SimpleModal({width:a,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:0.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}}).show({title:c,contents:b})},openModalImage:function(a){var b=a||{};var c=new SimpleModal({width:b.width,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:0.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});c.show({title:b.title,contents:'<img src="'+b.url+'" alt="">'})},openModalIframe:function(b){var c=b||{};var a=(window.getSize().y-180).toInt();if(!c.height||c.height>a){c.height=a}var d=new SimpleModal({width:c.width,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:0.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});d.show({title:c.title,contents:'<iframe src="'+c.url+'" width="100%" height="'+c.height+'" frameborder="0"></iframe>'})},openModalSelector:function(b){var c=b||{};var a=(window.getSize().y-180).toInt();if(!c.height||c.height>a){c.height=a}var d=new SimpleModal({width:c.width,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:0.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});d.addButton(Contao.lang.close,"btn",function(){this.hide()});d.addButton(Contao.lang.apply,"btn primary",function(){var h=[],l=[];var f=c.id.replace(/_[0-9]+$/,"")+"_parent";var g=window.frames[0].document.getElementById(f).getElementsByTagName("input");for(var e=0;e<g.length;e++){if(!g[e].checked||g[e].id.match(/^check_all_/)){continue}if(!g[e].id.match(/^reset_/)){var k=g[e].getParent("li").getFirst("div");l.push('<img src="'+k.getFirst("img").src+'" width="18" height="18" alt=""> '+k.getFirst("label").get("title"));h.push(g[e].get("value"))}}if(c.tag){$(c.tag).value=h.join(",");if(c.url.match(/page\.php/)){$(c.tag).value="{{link_url::"+$(c.tag).value+"}}"}c.self.set("href",c.self.get("href").replace(/&value=[^&]*/,"&value="+h.join(",")))}else{$("ctrl_"+c.id).value=h.join(",");$("target_"+c.id).getFirst("ul").removeClass("sgallery").set("html","<li>"+l.join("</li><li>")+"</li>");var j=$("target_"+c.id).getElement("a");j.set("href",j.get("href").replace(/&value=[^&]*/,"&value="+h.join(",")))}this.hide()});d.show({title:c.title,contents:'<iframe src="'+c.url+'" width="100%" height="'+c.height+'" frameborder="0"></iframe>',model:"modal"})},getScrollOffset:function(){document.cookie="BE_PAGE_OFFSET="+window.getScroll().y+"; path=/"},autoSubmit:function(a){Backend.getScrollOffset();var c=new Element("input",{type:"hidden",name:"SUBMIT_TYPE",value:"auto"});var b=$(a);c.inject(b,"bottom");b.submit()},vScrollTo:function(a){window.addEvent("load",function(){window.scrollTo(null,parseInt(a))})},showTreeBody:function(a,b){a.blur();$(b).setStyle("display",($(a).checked?"inline":"none"))},hideTreeBody:function(){var a=$$("ul");var c=null;for(var b=0;b<a.length;b++){if(a[b].hasClass("mandatory")){$("ctrl_"+a[b].id).checked="checked"}else{if(a[b].hasClass("tl_listing")&&(c=a[b].getFirst("li").getNext("li"))&&c.hasClass("parent")){c.setStyle("display","none")}}}},limitPreviewHeight:function(){var b=null;var d=null;var c="";var a=0;$$("div.limit_height").each(function(f){b=f.getCoordinates();if(a==0){a=f.className.replace(/[^0-9]*/,"").toInt()}if(!$chk(a)){return}f.setStyle("height",a);var e=Contao.script_url+"system/themes/"+Contao.theme+"/images/";d=new Element("img",{"class":"limit_toggler",alt:"",width:20,height:24});if(b.height<a){d.src=e+"expand_.gif";d.inject(f,"after");return}d.src=e+"expand.gif";d.setStyle("cursor","pointer");d.addEvent("click",function(){c=this.getPrevious("div").getStyle("height").toInt();this.getPrevious("div").setStyle("height",((c>a)?a:""));this.src=(this.src.indexOf("expand.gif")!=-1)?e+"collapse.gif":e+"expand.gif"});d.inject(f,"after")})},toggleCheckboxes:function(c,e){var b=$$("input");var a=c.checked?"checked":"";for(var d=0;d<b.length;d++){if(b[d].type.toLowerCase()!="checkbox"){continue}if(e&&b[d].id.substr(0,e.length)!=e){continue}b[d].checked=a}},toggleCheckboxGroup:function(c,e){var b=$(c).className;var a=$(c).checked?"checked":"";if(b=="tl_checkbox"){var d=$(e)?$$("#"+e+" .tl_checkbox"):$(c).getParent("fieldset").getElements(".tl_checkbox");d.each(function(f){f.checked=a})}else{if(b=="tl_tree_checkbox"){$$("#"+e+" .parent .tl_tree_checkbox").each(function(f){f.checked=a})}}Backend.getScrollOffset()},toggleCheckboxElements:function(c,b){var a=$(c).checked?"checked":"";$$("."+b).each(function(d){if(d.hasClass("tl_checkbox")){d.checked=a}});Backend.getScrollOffset()},toggleWrap:function(c){var b=$(c);var a=(b.getProperty("wrap")=="off")?"soft":"off";b.setProperty("wrap",a)},blink:function(){},addColorPicker:function(){return true},pickPage:function(c){var b=320;var a=112;Backend.currentId=c;Backend.ppValue=$(c).value;Backend.getScrollOffset();window.open($$("base")[0].href+"contao/page.php?value="+Backend.ppValue,"","width="+b+",height="+a+",modal=yes,left="+(Backend.xMousePosition?(Backend.xMousePosition-(b/2)):200)+",top="+(Backend.yMousePosition?(Backend.yMousePosition-(a/2)+80):100)+",location=no,menubar=no,resizable=yes,scrollbars=no,status=no,toolbar=no")},pickFile:function(d,c){var b=320;var a=112;Backend.currentId=d;Backend.ppValue=$(d).value;Backend.getScrollOffset();window.open($$("base")[0].href+"contao/file.php?value="+Backend.ppValue+"&filter="+c,"","width="+b+",height="+a+",modal=yes,left="+(Backend.xMousePosition?(Backend.xMousePosition-(b/2)):200)+",top="+(Backend.yMousePosition?(Backend.yMousePosition-(a/2)+80):100)+",location=no,menubar=no,resizable=yes,scrollbars=no,status=no,toolbar=no")},collapsePalettes:function(a){$$("fieldset.hide").each(function(b){b.addClass("collapsed")});$$("label.error","label.mandatory").each(function(b){if(fs=b.getParent("fieldset")){fs.removeClass("collapsed")}})},addInteractiveHelp:function(){new Tips.Contao("p.tl_tip",{offset:{x:9,y:21},text:function(a){return a.get("html")}});["a[title]","input[title]"].each(function(a){new Tips.Contao($$(a),{offset:{x:0,y:26}})});new Tips.Contao("img[title]",{offset:{x:0,y:30}})},makeParentViewSortable:function(a){var b=new Sortables(a,{contstrain:true,opacity:0.6});b.active=false;b.addEvent("start",function(){b.active=true});b.addEvent("complete",function(e){if(!b.active){return}if(e.getPrevious("li")){var g=e.get("id").replace(/li_/,"");var d=e.getPrevious("li").get("id").replace(/li_/,"");var f=window.location.search.replace(/id=[0-9]*/,"id="+g)+"&act=cut&mode=1&pid="+d;var c=window.location.href.replace(/\?.*$/,"");new Request({url:c+f}).get()}else{if(e.getParent("ul")){var g=e.get("id").replace(/li_/,"");var d=e.getParent("ul").get("id").replace(/ul_/,"");var f=window.location.search.replace(/id=[0-9]*/,"id="+g)+"&act=cut&mode=2&pid="+d;var c=window.location.href.replace(/\?.*$/,"");new Request({url:c+f}).get()}}})},makeMultiSrcSortable:function(c,a){var b=new Sortables($(c),{contstrain:true,opacity:0.6}).addEvent("complete",function(){var e=[];var d=$(c).getChildren("li");for(i=0;i<d.length;i++){e.push(d[i].get("data-id"))}$(a).value=e.join(",")});b.fireEvent("complete")},makeCheckboxWizardSortable:function(b){var a=new Sortables($(b).getElement(".sortable"),{contstrain:true,opacity:0.6})},listWizard:function(b,c,a){var f=$(a);var j=$(b).getParent("li");var g=f.getChildren();Backend.getScrollOffset();switch(c){case"copy":var h=j.clone(true).inject(j,"before");if(input=j.getFirst("input")){h.getFirst("input").value=input.value}break;case"up":if(previous=j.getPrevious("li")){j.inject(previous,"before")}else{j.inject(f,"bottom")}break;case"down":if(next=j.getNext("li")){j.inject(next,"after")}else{j.inject(f.getFirst("li"),"before")}break;case"delete":if(g.length>1){j.destroy()}break}rows=f.getChildren();var d=1;for(var e=0;e<rows.length;e++){if(input=rows[e].getFirst('input[type="text"]')){input.set("tabindex",d++)}}},tableWizard:function(c,e,n){var s=$(n);var a=s.getElement("tbody");var k=a.getChildren();var m=$(c).getParent("td");var f=m.getParent("tr");var l=f.getChildren();var h=0;for(var r=0;r<l.length;r++){if(l[r]==m){break}h++}Backend.getScrollOffset();switch(e){case"rcopy":var b=new Element("tr");for(var r=0;r<l.length;r++){var o=l[r].clone(true).inject(b,"bottom");if(textarea=l[r].getFirst("textarea")){o.getFirst("textarea").value=textarea.value}}b.inject(f,"after");break;case"rup":var d=f.getPrevious("tr");if(d.getPrevious("tr")){f.inject(d,"before")}else{f.inject(a,"bottom")}break;case"rdown":if(o=f.getNext("tr")){f.inject(o,"after")}else{f.inject(a.getFirst("tr").getNext("tr"),"before")}break;case"rdelete":if(k.length>2){f.destroy()}break;case"ccopy":for(var r=0;r<k.length;r++){var p=k[r].getChildren()[h];var o=p.clone(true).inject(p,"after");if(textarea=p.getFirst("textarea")){o.getFirst("textarea").value=textarea.value}}break;case"cmovel":if(h>0){for(var r=0;r<k.length;r++){var p=k[r].getChildren()[h];p.inject(p.getPrevious(),"before")}}else{for(var r=0;r<k.length;r++){var p=k[r].getChildren()[h];p.inject(k[r].getLast(),"before")}}break;case"cmover":if(h<(l.length-2)){for(var r=0;r<k.length;r++){var p=k[r].getChildren()[h];p.inject(p.getNext(),"after")}}else{for(var r=0;r<k.length;r++){var p=k[r].getChildren()[h];p.inject(k[r].getFirst(),"before")}}break;case"cdelete":if(l.length>2){for(var r=0;r<k.length;r++){k[r].getChildren()[h].destroy()}}break}k=a.getChildren();var t=1;for(var r=0;r<k.length;r++){var g=k[r].getChildren();for(var q=0;q<g.length;q++){if(textarea=g[q].getFirst("textarea")){textarea.set("tabindex",t++);textarea.name=textarea.name.replace(/\[[0-9]+\][[0-9]+\]/ig,"["+(r-1)+"]["+q+"]")}}}Backend.tableWizardResize()},tableWizardResize:function(b){var a=Cookie.read("BE_CELL_SIZE");if(a==null&&b==null){return}if(b!=null){var a="";$$(".tl_tablewizard textarea").each(function(d){d.setStyle("width",(d.getStyle("width").toInt()*b).round().limit(142,284));d.setStyle("height",(d.getStyle("height").toInt()*b).round().limit(66,132));if(a==""){a=d.getStyle("width")+"|"+d.getStyle("height")}});Cookie.write("BE_CELL_SIZE",a)}else{if(a!=null){var c=a.split("|");$$(".tl_tablewizard textarea").each(function(d){d.setStyle("width",c[0]);d.setStyle("height",c[1])})}}},moduleWizard:function(b,c,a){var n=$(a);var g=n.getElement("tbody");var m=$(b).getParent("tr");var o=g.getChildren();Backend.getScrollOffset();switch(c){case"copy":var l=new Element("tr");var k=m.getChildren();for(var f=0;f<k.length;f++){var h=k[f].clone(true).inject(l,"bottom");if(select=k[f].getFirst("select")){h.getFirst("select").value=select.value}}l.inject(m,"after");l.getElement(".chzn-container").destroy();new Chosen(l.getElement("select.tl_select"));Stylect.convertSelects();break;case"up":if(l=m.getPrevious("tr")){m.inject(l,"before")}else{m.inject(g,"bottom")}break;case"down":if(l=m.getNext("tr")){m.inject(l,"after")}else{m.inject(g,"top")}break;case"delete":if(o.length>1){m.destroy()}break}o=g.getChildren();var e=1;for(var f=0;f<o.length;f++){var k=o[f].getChildren();for(var d=0;d<k.length;d++){if(select=k[d].getFirst("select")){select.set("tabindex",e++);select.name=select.name.replace(/\[[0-9]+\]/ig,"["+f+"]")}}}},optionsWizard:function(b,c,a){var n=$(a);var g=n.getElement("tbody");var m=$(b).getParent("tr");var o=g.getChildren();Backend.getScrollOffset();switch(c){case"copy":var l=new Element("tr");var k=m.getChildren();for(var f=0;f<k.length;f++){var h=k[f].clone(true).inject(l,"bottom");if(input=k[f].getFirst("input")){h.getFirst("input").value=input.value;if(input.type=="checkbox"){h.getFirst("input").checked=input.checked?"checked":""}}}l.inject(m,"after");break;case"up":if(l=m.getPrevious("tr")){m.inject(l,"before")}else{m.inject(g,"bottom")}break;case"down":if(l=m.getNext("tr")){m.inject(l,"after")}else{m.inject(g,"top")}break;case"delete":if(o.length>1){m.destroy()}break}o=g.getChildren();var e=1;for(var f=0;f<o.length;f++){var k=o[f].getChildren();for(var d=0;d<k.length;d++){if(input=k[d].getFirst("input")){input.set("tabindex",e++);input.name=input.name.replace(/\[[0-9]+\]/g,"["+f+"]");if(input.type=="checkbox"){input.id=input.name.replace(/\[[0-9]+\]/g,"").replace(/\[/g,"_").replace(/\]/g,"")+"_"+f;input.getNext("label").set("for",input.id)}}}}},keyValueWizard:function(b,c,a){var n=$(a);var g=n.getElement("tbody");var m=$(b).getParent("tr");var o=g.getChildren();Backend.getScrollOffset();switch(c){case"copy":var l=new Element("tr");var k=m.getChildren();for(var f=0;f<k.length;f++){var h=k[f].clone(true).inject(l,"bottom");if(input=k[f].getFirst("input")){h.getFirst().value=input.value}}l.inject(m,"after");break;case"up":if(l=m.getPrevious("tr")){m.inject(l,"before")}else{m.inject(g,"bottom")}break;case"down":if(l=m.getNext("tr")){m.inject(l,"after")}else{m.inject(g,"top")}break;case"delete":if(o.length>1){m.destroy()}break}o=g.getChildren();var e=1;for(var f=0;f<o.length;f++){var k=o[f].getChildren();for(var d=0;d<k.length;d++){if(input=first=k[d].getFirst("input")){input.set("tabindex",e++);input.name=input.name.replace(/\[[0-9]+\]/g,"["+f+"]")}}}},checkboxWizard:function(c,d,e){var a=$(e);var b=$(c).getParent("span");Backend.getScrollOffset();switch(d){case"up":if((span=b.getPrevious("span"))&&!span.hasClass("fixed")){b.inject(span,"before")}else{b.inject(a,"bottom")}break;case"down":if(span=b.getNext("span")){b.inject(span,"after")}else{if(all=a.getFirst("span.fixed")){b.inject(all,"after")}}break}},metaWizard:function(f,d){var c=f.getParent("div").getElement("select");if(c.value==""){return}var a=$(d).getLast("li").clone();var e=a.getElement("span");var b=e.getElement("img");e.set("text",c.options[c.selectedIndex].text+" ");b.inject(e,"bottom");a.getElements("input").each(function(h){h.value="";h.name=h.name.replace(/\[[a-z]{2}\]/,"["+c.value+"]");var j=h.getPrevious("label");var g=parseInt(j.get("for").replace(/ctrl_[^_]+_/,""));j.set("for",j.get("for").replace(g,g+1));h.id=j.get("for")});a.className=(a.className=="even")?"odd":"even";a.inject($(d),"bottom");f.getParent("div").getElement('input[type="button"]').setProperty("disabled",true);c.removeChild(c.options[c.selectedIndex]);c.fireEvent("liszt:updated")},toggleAddLanguageButton:function(a){var b=a.getParent("div").getElement('input[type="button"]');if(a.value!=""){b.removeProperty("disabled")}else{b.setProperty("disabled",true)}},updateModuleLink:function(c){var d=c.getParent("td").getNext("td");var b=d.getElement("a.module_link");b.href=b.href.replace(/id=[0-9]+/,"id="+c.value);if(c.value>0){d.getElement("a.module_link").setStyle("display","inline");d.getElement("img.module_image").setStyle("display","none")}else{d.getElement("a.module_link").setStyle("display","none");d.getElement("img.module_image").setStyle("display","inline")}}};document.addEvent("mousedown",function(a){Backend.getMousePosition(a)});window.addEvent("domready",function(){if(Elements.chosen!=undefined){$$("select.tl_chosen").chosen()}$$("textarea.monospace").each(function(a){Backend.toggleWrap(a)});Backend.collapsePalettes();Backend.addInteractiveHelp();Backend.addColorPicker()});window.addEvent("load",function(){Backend.limitPreviewHeight()});window.addEvent("ajax_change",function(){if(Elements.chosen!=undefined){$$("select.tl_chosen").filter(function(a){return a.getStyle("display")!="none"}).chosen()}Backend.addInteractiveHelp()});var ContextMenu={initialize:function(){$$("a.edit-header").each(function(a){a.addClass("invisible")});$$("a.contextmenu").each(function(b){var a=b.getNext("a");if(!a||!a.hasClass("edit-header")){return}b.addEvent("contextmenu",function(c){c.preventDefault();ContextMenu.show(b,a,c)})});$(document.body).addEvent("click",function(){ContextMenu.hide()})},show:function(d,c,f){ContextMenu.hide();var b=d.getFirst("img");var a=c.getFirst("img");var g=new Element("div",{id:"contextmenu",html:'<a href="'+d.href+'" title="'+d.title+'">'+d.get("html")+" "+b.alt+'</a><a href="'+c.href+'" title="'+c.title+'">'+c.get("html")+" "+a.alt+"</a>",styles:{top:(d.getPosition().y-6)+"px"}}).inject($(document.body),"bottom");g.setStyle("left",d.getPosition().x-(g.getSize().x/2))},hide:function(){if($("contextmenu")!=null){$("contextmenu").destroy()}}};window.addEvent("domready",function(){ContextMenu.initialize()});window.addEvent("structure",function(){ContextMenu.initialize()});var TinyCallback={getScrollOffset:function(a){tinymce.dom.Event.add((tinymce.isGecko?a.getDoc():a.getWin()),"focus",function(){Backend.getScrollOffset()})}};